{% extends 'admin/master.html' %}
{% import 'admin/lib.html' as lib with context %}
{% import 'admin/static.html' as admin_static with context %}
{% import 'admin/model/layout.html' as model_layout with context %}

{% block head %}
	{{ super() }}
{% endblock %}

{% block body %}
	<h2>Processes Status</h2>
	{% block model_menu_bar %}
	{% endblock %}

	{% block model_list_table %}
		<table class='table table-striped table-bordered table-hover model-list'>
			<thead>
				<tr>
					<th class='column-header'>Name</th>
					<th class='column-header'>Most Recent Run State</th>
					<th class='column-header'>Current Task</th>
					<th class='column-header'>Previous Run Status</th>
					<th class='column-header'>Last Successful Task</th>
					<th class='column-header'>Next Scheduled</th>
				</tr>
			</thead>
<!--     What scrapers are currently running? What are they scraping? E.g., bills updated in the last day.
	When did each scraper last run successfully? What did it scrape?
		Have any scrapers failed since their last successful run?
	When will each scraper run next? Or maybe, what is the scraping schedule for the current hour?
	Ditto the above questions for Metro ETL (though these scripts run on a more regular basis and fail significantly less often than the scrapers) -->
			{% for dag in data %}
				<tr>
					<td>{{ dag.name }}</td>
					<td>{{ dag.state }}</td>
					<td>task name or "not running"</td>
					<td>date of last successful run</td>
					<td>last successful task</td>
					<td>date of next scheduled run</td>
				</tr>
			{% endfor %}
		</table>
	{% endblock %}

{% endblock %}

{% block tail %}
	{{ super() }}
	<script src='{{ admin_static.url(filename="admin/js/filters.js") }}'></script>
	{{ lib.form_js() }}
{% endblock %}
